<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
	<script src="moment.js"></script>
	<link rel="stylesheet" type="text/css" href = "style.css"> 
  </head>

  <body>
  	<h1>Twittler</h1>
	<div class="update">0 new Tweets</div>
    <script>

      $(document).ready(function(){
        var $body = $('body');
		
		var newTweets = 0;
		
		var newTweet = function(i){
			var tweet = streams.home[i];
			var $tweet = $('<div class="new tweet"></div>');
			var timeCreated = tweet.created_at;
			var time = moment(timeCreated).fromNow();
			$tweet.addClass(tweet.user);
			$tweet.append('<p id="message">' + tweet.message + '</p>');
			$tweet.append('<h2><span class="name">' + '@' + tweet.user + ' </span><font size=3px>' + time + '</font></h2>');
			
			$('.update').after($tweet);
		}
		
		var update = function(){
			var first = 0;			
			
			while(newTweets < streams.home.length){
				newTweet(newTweets);
				newTweets++;
			}
			$('.tweet').removeClass('new');
			
		}
		
		$('.update').on('click',function(){
			$('.tweet').show();
			update();
			$('.update').text('0 new Tweets');
		});
		
		update();		
		setInterval(function(){
			var totalTweets = streams.home.length - newTweets;
			$('.update').text( totalTweets + " new Tweets");
		}, 2000);
		
		
      });

    </script>
  </body>
</html>
